(this["webpackJsonpidx-account-linker"]=this["webpackJsonpidx-account-linker"]||[]).push([[0],{1074:function(e,t){},1138:function(e,t){},1190:function(e,t){},1514:function(e,t,n){"use strict";n.r(t);var r=n(4),c=n.n(r),a=n(247),s=n.n(a),i=(n(638),n(71)),o=n(33),u=n(2),d=n.n(u),j=n(150),l=n(609),b=n.n(l),f=n(349),h=n.n(f),p=n(612),O=n.n(p),x=n(355),m=n(62),g=n(359),v=Object(g.b)({name:"page",initialState:{step:1,address:null,username:null},reducers:{nextPage:function(e){return Object(m.a)(Object(m.a)({},e),{},{step:e.step+1})},lastPage:function(e){return Object(m.a)(Object(m.a)({},e),{},{step:e.step+1})},setAddress:function(e,t){return Object(m.a)(Object(m.a)({},e),{},{address:t.payload})},setUsername:function(e,t){return Object(m.a)(Object(m.a)({},e),{},{username:t.payload})},setDID:function(e,t){return Object(m.a)(Object(m.a)({},e),{},{did:t.payload})}}}),y=Object(g.a)({reducer:v.reducer}),w=function(e){return y.dispatch(v.actions.setAddress(e))},k=function(e){return y.dispatch(v.actions.setUsername(e))},C=function(e){return y.dispatch(v.actions.setDID(e))},S=n(1540),D=n(360),I=n(361),A=n(1521),P=n(1541),U=n(1535),E=n(616),J=n.n(E),L=n(18),N=Object(i.b)((function(e){return{address:e.address,did:e.did}}))((function(e){var t=e.address,n=e.setCeramic,c=e.did,a=Object(r.useState)(),s=Object(o.a)(a,2),i=s[0],u=s[1],l={walletconnect:{package:O.a,options:{infuraId:"24eb2385c3514f3d98191ad5e4c903e7"}}},f=new h.a({cacheProvider:!0,providerOptions:l}),p=function(){var e=Object(j.a)(d.a.mark((function e(){var t,r,c,a,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.connect();case 2:return t=e.sent,r=new b.a(t),u(r),e.next=7,r.eth.getAccounts();case 7:return c=e.sent,a=c[0],w(a),s=new x.ThreeIdConnect,e.next=13,s.connect(new x.EthereumAuthProvider(t,a));case 13:return i=new J.a("https://ceramic-clay.3boxlabs.com"),e.next=16,i.setDIDProvider(s.getDidProvider());case 16:n(i),C(i.did.id);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(j.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c||"injected"!==f.cachedProvider){e.next=3;break}return e.next=3,p();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){return m()}),[]),t?Object(L.jsxs)(S.a,{children:[Object(L.jsxs)(D.a,{children:["Using:",Object(L.jsx)("span",{children:" "}),Object(L.jsxs)("span",{title:t,children:[t.slice(0,10),"\u2026",t.slice(-5)]}),Object(L.jsx)("span",{children:" "}),Object(L.jsx)(U.a,{onClick:Object(j.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(w(),e.t0=null===i||void 0===i||null===(t=i.currentProvider)||void 0===t?void 0:t.disconnect,!e.t0){e.next=5;break}return e.next=5,i.currentProvider.disconnect();case 5:case"end":return e.stop()}}),e)})))})]}),!c&&Object(L.jsx)(I.a,{children:Object(L.jsx)(A.a,{})})]}):Object(L.jsx)(I.a,{children:Object(L.jsx)(P.a,{onClick:p,children:"Connect Your Wallet"})})})),B=n(1539),F=Object(i.b)((function(e){return{username:e.username}}))((function(e){var t=e.username,n=Object(r.useState)(t),c=Object(o.a)(n,2),a=c[0],s=c[1];if(t)return Object(L.jsx)(I.a,{children:Object(L.jsxs)(D.a,{children:["Checking: ",t,Object(L.jsx)("span",{children:" "}),Object(L.jsx)(U.a,{onClick:function(){return k()}})]})});return Object(L.jsxs)(I.a,{children:[Object(L.jsxs)(D.a,{children:["\xbfWhat's your ",Object(L.jsx)("a",{href:"//github,com",children:"Github"})," username?"]}),Object(L.jsx)("form",{onSubmit:function(e){console.info("SUB",t),e.preventDefault(),k(a)},children:Object(L.jsx)(B.a,{onChange:function(e){return s(e.target.value)}})})]})})),T=n(1536),W=n(1537),$=Object(i.b)((function(e){return{did:e.did,username:e.username}}))((function(e){var t=e.did,n=e.username,r=Object(T.a)(t).onCopy;return Object(L.jsx)(I.a,{children:Object(L.jsxs)(S.a,{children:[Object(L.jsxs)(D.a,{children:["Copy your DID to a",Object(L.jsx)("span",{children:" "}),Object(L.jsx)("a",{target:"_blank",href:"//gist.github.com/".concat(n),children:"gist"}),"."]}),Object(L.jsxs)(D.a,{children:[Object(L.jsxs)("span",{title:t,children:[t.slice(0,10),"\u2026",t.slice(-5)]}),Object(L.jsx)("span",{children:" "}),Object(L.jsx)(W.a,{title:"copy",onClick:r})]})]})})})),q=n(620),K=n(1538),V=Object(i.b)((function(e){return{address:e.address,username:e.username,did:e.did}}))((function(e){e.address;var t=e.username,n=e.did,c=Object(r.useState)(),a=Object(o.a)(c,2),s=a[0],i=a[1],u=[];return u.push(Object(L.jsx)(N,{setCeramic:i})),n&&(u.push(Object(L.jsx)(F,{})),t&&(u.push(Object(L.jsx)($,{})),u.push(Object(L.jsx)(q.a,{ceramic:s})))),Object(L.jsx)(K.a,{children:Object(L.jsx)(S.a,{children:u})})})),z=function(){return Object(L.jsx)(i.a,{store:y,children:Object(L.jsx)(V,{})})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1542)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(L.jsx)(c.a.StrictMode,{children:Object(L.jsx)(z,{})}),document.getElementById("root")),G()},620:function(e,t,n){"use strict";(function(e){var r=n(2),c=n.n(r),a=n(62),s=n(66),i=n(150),o=n(33),u=n(4),d=n(71),j=n(361),l=n(360),b=n(1521),f=n(627),h=n(625),p=n(628),O=n(18),x="https://oiekhuylog.execute-api.us-west-2.amazonaws.com/develop",m="aka",g=function(t){var n=e.from(t,"base64").toString();try{return JSON.parse(n)}catch(r){return n}},v=function(e){return[e.signatures[0].protected,e.payload,e.signatures[0].signature].join(".")};t.a=Object(d.b)((function(e){return{did:e.did,username:e.username}}))((function(e){var t=e.did,n=e.username,r=e.ceramic,d=Object(u.useState)(!1),y=Object(o.a)(d,2),w=y[0],k=y[1],C=Object(u.useState)(),S=Object(o.a)(C,2),D=S[0],I=S[1],A=function(){var e=Object(i.a)(c.a.mark((function e(){var i,o,u,d,j,l,b,O,y,w,C,S,D,A,P,U,E,J;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,j="".concat(x,"/api/v0/request-github"),console.info(JSON.stringify({did:t,username:n})),e.next=5,fetch(j,{method:"post",body:JSON.stringify({did:t,username:n})});case 5:return l=e.sent,e.next=8,l.json();case 8:if(b=e.sent,O=null===(i=b)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.challengeCode){e.next=12;break}throw new Error("Couldn't generate challenge");case 12:return e.t0=v,e.next=15,r.did.createJWS({challengeCode:O});case 15:return e.t1=e.sent,y=(0,e.t0)(e.t1),j="".concat(x,"/api/v0/confirm-github"),e.next=20,fetch(j,{method:"post",body:JSON.stringify({jws:y})});case 20:return l=e.sent,e.next=23,l.json();case 23:if("error"!==(b=e.sent).status){e.next=26;break}throw new Error(b.message);case 26:if(!(b.status>=300)){e.next=28;break}throw new Error(b.body);case 28:if(w=null===(u=b)||void 0===u||null===(d=u.data)||void 0===d?void 0:d.attestation){e.next=31;break}throw new Error("missing attestation");case 31:return C=null===w||void 0===w?void 0:w.split(".").map(g),S=C[1].vc.credentialSubject.account,D={protocol:"https",host:"github.com",id:S.username,claim:S.url,attestations:[{"did-jwt-vc":w}]},e.next=36,r.createDocument("tile",{deterministic:!0,content:h});case 36:return A=e.sent,console.info("akaType",{id:A.id.toUrl(),commit:A.commitId.toUrl()}),e.next=40,Object(f.a)(r,{name:"AsKnownAs",description:"Account links to an IDX DID",schema:A.commitId.toUrl()});case 40:return P=e.sent,console.info("akaDef",{id:P.id.toUrl(),commit:P.commitId.toUrl()}),U=Object(s.a)({},m,[P.commitId.toUrl()]),E=new p.a({ceramic:r,aliases:U}),e.next=46,E.get(m);case 46:if(e.t2=e.sent,e.t2){e.next=49;break}e.t2={accounts:[]};case 49:if(J=e.t2,console.info("existing",Object(a.a)({},J)),J.accounts){e.next=53;break}throw new Error("malformed ".concat(m," entry"));case 53:return J.accounts.push(D),console.info("new",Object(a.a)({},J)),e.t3=console,e.next=58,E.merge(m,J);case 58:e.t4=e.sent.toUrl(),e.t3.info.call(e.t3,"repo",e.t4),k(!0),e.next=67;break;case 63:e.prev=63,e.t5=e.catch(0),console.error(e.t5),I(e.t5.message);case 67:case"end":return e.stop()}}),e,null,[[0,63]])})));return function(){return e.apply(this,arguments)}}();return Object(u.useEffect)((function(){return A()}),[]),D?Object(O.jsx)(j.a,{children:Object(O.jsxs)(l.a,{children:["Error: ",D]})}):w?Object(O.jsx)(j.a,{children:Object(O.jsx)(l.a,{children:"Verified"})}):Object(O.jsx)(j.a,{children:Object(O.jsxs)(l.a,{children:["Verifying gist for ",n,". ",Object(O.jsx)(b.a,{})]})})}))}).call(this,n(11).Buffer)},625:function(e){e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","type":"object","title":"AlsoKnownAs","properties":{"accounts":{"type":"array","items":{"$ref":"#/definitions/Account"}}},"definitions":{"Attestation":{"type":"object","properties":{"did-jwt":{"type":"string","maxLength":1000},"did-jwt-vc":{"type":"string","maxLength":1000}}},"Account":{"type":"object","properties":{"protocol":{"type":"string","maxLength":50},"host":{"type":"string","maxLength":150},"id":{"type":"string","maxLength":450},"claim":{"type":"string","maxLength":450},"attestations":{"type":"array","items":{"$ref":"#/definitions/Attestation"}}},"required":["protocol","id"]}}}')},638:function(e,t,n){},654:function(e,t){},674:function(e,t){},676:function(e,t){},749:function(e,t){},751:function(e,t){},783:function(e,t){},788:function(e,t){},790:function(e,t){},797:function(e,t){},810:function(e,t){},892:function(e,t){}},[[1514,1,2]]]);
//# sourceMappingURL=main.b6540122.chunk.js.map